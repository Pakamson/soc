<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Inventory System</title>
    <style>
      body { font-family: Arial, sans-serif; max-width: 720px; margin: 40px auto; }
      label { display:block; margin-top:12px }
      input, textarea { width:100%; padding:8px; box-sizing:border-box }
      button { margin-top:12px; padding:8px 16px }
      .result { margin-top:16px; padding:8px; border-radius:4px }
      .ok { background:#e6ffed; border:1px solid #8ee0a1 }
      .err { background:#ffe6e6; border:1px solid #e08e8e }

      .nav-links {
        margin-bottom: 20px;
      }
      .nav-links a {
        margin-right: 15px;
        color: #0066cc;
        text-decoration: none;
      }
      .nav-links a:hover {
        text-decoration: underline;
      }
    </style>
  </head>
  <body>
    <div class="nav-links">
      <a href="/">Add New Item</a>
      <a href="/search">Quick Search</a>
      <a href="/advanced-search">Advanced Search</a>
      <a href="/bulk-import">Bulk Import</a>
    </div>

    <h1>SOC Inventory - Add Item</h1>

    <form id="itemForm">
      <div style="display:grid; grid-template-columns:1fr 1fr; gap:12px;">
        <div>
          <label for="record_date">Record Date</label>
          <input id="record_date" name="record_date" type="date" />

          <label for="label">Label</label>
          <input id="label" name="label" maxlength="100" />

          <label for="type">Type</label>
          <input id="type" name="type" maxlength="100" />

          <label for="brand">Brand</label>
          <input id="brand" name="brand" maxlength="100" />

          <label for="model_no">Model Number</label>
          <input id="model_no" name="model_no" maxlength="100" />

          <label for="serial_no">Serial Number</label>
          <input id="serial_no" name="serial_no" maxlength="100" />
        </div>

        <div>
          <label for="location">Location</label>
          <input id="location" name="location" maxlength="100" />

          <label for="location_2">Location 2</label>
          <input id="location_2" name="location_2" maxlength="100" />

          <label for="invoice_no">Invoice Number</label>
          <input id="invoice_no" name="invoice_no" maxlength="100" />

          <label for="purchase_date">Purchase Date</label>
          <input id="purchase_date" name="purchase_date" type="date" />

          <label for="price">Price</label>
          <input id="price" name="price" type="number" step="0.01" />

          <label for="maintenance_end_date">Maintenance End Date</label>
          <input id="maintenance_end_date" name="maintenance_end_date" type="date" />

          <label for="status">Status</label>
          <input id="status" name="status" maxlength="50" />
        </div>
      </div>

      <div style="margin-top:12px">
        <button type="submit">Add / Update Item</button>
      </div>
    </form>

    <div id="result" class="result" style="display:none"></div>

    <script>
      const form = document.getElementById('itemForm')
      const resultEl = document.getElementById('result')
 

      form.addEventListener('submit', async (e) => {
        e.preventDefault()
        resultEl.style.display = 'none'

        const payload = {
          record_date: document.getElementById('record_date').value || null,
          label: document.getElementById('label').value.trim() || null,
          type: document.getElementById('type').value.trim() || null,
          brand: document.getElementById('brand').value.trim() || null,
          model_no: document.getElementById('model_no').value.trim() || null,
          serial_no: document.getElementById('serial_no').value.trim() || null,
          location: document.getElementById('location').value.trim() || null,
          location_2: document.getElementById('location_2').value.trim() || null,
          invoice_no: document.getElementById('invoice_no').value.trim() || null,
          purchase_date: document.getElementById('purchase_date').value || null,
          price: document.getElementById('price').value || null,
          maintenance_end_date: document.getElementById('maintenance_end_date').value || null,
          status: document.getElementById('status').value.trim() || null,
        }

        try {
          const res = await fetch('/api/items', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(payload)
          })

          const data = await res.json()
          if (res.ok) {
            resultEl.className = 'result ok'
            resultEl.style.display = 'block'
                        resultEl.textContent = `Item saved successfully: ${data.message || ''}`
            form.reset()
          } else {
            resultEl.className = 'result err'
            resultEl.style.display = 'block'
            resultEl.textContent = (data && data.error) ? data.error : 'Failed to save item'
          }
        } catch (err) {
          resultEl.className = 'result err'
          resultEl.style.display = 'block'
          resultEl.textContent = 'Network error: ' + err.message
        }
      })


    </script>
  </body>
</html>
